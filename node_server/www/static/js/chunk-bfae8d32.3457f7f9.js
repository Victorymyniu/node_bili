(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bfae8d32"],{"0a49":function(t,e,o){var i=o("9b43"),a=o("626a"),r=o("4bf8"),n=o("9def"),c=o("cd1c");t.exports=function(t,e){var o=1==t,s=2==t,l=3==t,p=4==t,u=6==t,m=5==t||u,d=e||c;return function(e,c,f){for(var v,h,g=r(e),b=a(g),w=i(c,f,3),P=n(b.length),_=0,j=o?d(e,P):s?d(e,0):void 0;P>_;_++)if((m||_ in b)&&(v=b[_],h=w(v,_,g),t))if(o)j[_]=h;else if(h)switch(t){case 3:return!0;case 5:return v;case 6:return _;case 2:j.push(v)}else if(p)return!1;return u?-1:l||p?p:j}}},"13c0":function(t,e,o){},"27cb":function(t,e,o){"use strict";var i=o("13c0"),a=o.n(i);a.a},7514:function(t,e,o){"use strict";var i=o("5ca1"),a=o("0a49")(5),r="find",n=!0;r in[]&&Array(1)[r]((function(){n=!1})),i(i.P+i.F*n,"Array",{find:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}}),o("9c6c")(r)},"77d2":function(t,e,o){"use strict";o.r(e);var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"app-container"},[o("el-dialog",{attrs:{title:t.title,visible:t.newPageVisible,"before-close":t.close,width:"75%"},on:{"update:visible":function(e){t.newPageVisible=e}}},[o("el-form",{ref:"topicSubmitForm",staticClass:"new-user-dialog",attrs:{model:t.topicParam,rules:t.topicSubmitRules,inline:!0,"label-width":"110px","label-position":"left"}},[o("el-row",[o("el-col",{attrs:{span:10}},[o("el-form-item",{attrs:{label:"所属项目：",prop:"projectId"}},[o("el-select",{attrs:{placeholder:"请输入所属项目"},model:{value:t.topicParam.projectId,callback:function(e){t.$set(t.topicParam,"projectId",e)},expression:"topicParam.projectId"}},t._l(t.userProjectSelects,(function(t,e){return o("el-option",{key:t+e,attrs:{label:t.projectCode,value:t.id}})})),1)],1)],1),t._v(" "),o("el-col",{attrs:{span:14}},[o("el-form-item",{attrs:{label:"Topic名称：",prop:"topicName"}},[o("el-input",{attrs:{disabled:t.isDisabled,type:"text",maxlength:"50","show-word-limit":"",placeholder:"最大字符数不超过50个"},model:{value:t.topicParam.topicName,callback:function(e){t.$set(t.topicParam,"topicName",e)},expression:"topicParam.topicName"}}),t._v(" "),o("span",{staticClass:"prefix-tip"},[t._v("(注：格式必须以所选项目加 “_” 为前缀)")])],1)],1)],1),t._v(" "),o("el-row",[o("el-col",{attrs:{span:10}},[o("el-form-item",{attrs:{label:"分类标签：",prop:"topicFlag"}},[o("el-input",{attrs:{type:"text",maxlength:"50","show-word-limit":"",placeholder:"最大字符数不超过50个"},model:{value:t.topicParam.topicFlag,callback:function(e){t.$set(t.topicParam,"topicFlag",e)},expression:"topicParam.topicFlag"}})],1)],1),t._v(" "),o("el-col",{attrs:{span:14}},[o("el-form-item",{attrs:{label:"Partition数量：",prop:"partitionNum"}},[o("el-input",{attrs:{disabled:t.partitionChecked},model:{value:t.topicParam.partitionNum,callback:function(e){t.$set(t.topicParam,"partitionNum",t._n(e))},expression:"topicParam.partitionNum"}}),t._v(" "),t.isDisabled?t._e():o("el-checkbox",{staticClass:"defaultChecked",model:{value:t.partitionChecked,callback:function(e){t.partitionChecked=e},expression:"partitionChecked"}},[t._v("默认")])],1)],1)],1),t._v(" "),o("el-form-item",{staticClass:"item_textarea",attrs:{label:"备注：",prop:"topicDesc"}},[o("el-input",{attrs:{autosize:{minRows:2,maxRows:5},type:"textarea",maxlength:"100",placeholder:"最大字符数不超过100"},model:{value:t.topicParam.topicDesc,callback:function(e){t.$set(t.topicParam,"topicDesc",e)},expression:"topicParam.topicDesc"}})],1)],1),t._v(" "),o("div",{staticClass:"btn_group"},[o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm("topicSubmitForm","save")}}},[t._v("保存")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm("topicSubmitForm","submit")}}},[t._v("提交")]),t._v(" "),o("el-button",{on:{click:t.close}},[t._v("取消")])],1)],1)],1)},a=[],r=(o("7514"),o("abad")),n={name:"TopicDetail",props:{title:{type:String,default:""},newPageVisible:{type:Boolean,default:!1},currentRow:{type:Object,default:function(){}}},data:function(){var t=function(t,e,o){if(!e)return o(new Error("Topic名称是必填的"));var i=/^[\w|/-]+$/;setTimeout((function(){i.test(e)?o():o(new Error("Topic名称只包含字母，数字，下划线或中划线"))}),100)};return{topicParam:{id:null,partitionNum:1,projectId:null,topicDesc:"",topicFlag:"",topicName:"",topicStatus:""},topicSubmitRules:{partitionNum:[{required:!0,message:"Partition数量不能为空",trigger:"blur"},{type:"number",message:"Partition数量必须为数字值"}],projectId:[{required:!0,message:"所属项目是必填的",trigger:"change"}],topicName:[{required:!0,validator:t,trigger:"blur"}]},userProjectSelects:[],projectCode:"",partitionChecked:!0,isDisabled:!1}},created:function(){this.getProjectList()},methods:{setDefaultChecked:function(){this.partitionChecked=!0},getRowData:function(t){var e=t.id,o=t.partitionNum,i=t.projectId,a=t.topicDesc,r=t.topicFlag,n=t.topicName,c=t.topicStatus;this.topicParam={id:e,partitionNum:o,projectId:i,topicDesc:a,topicFlag:r,topicName:n,topicStatus:c},4===c?(this.isDisabled=!0,this.partitionChecked=!0):this.isDisabled=!1},getProjectList:function(){var t=this;Object(r["i"])().then((function(e){t.userProjectSelects=e.datas}))},topicProjectChange:function(t){var e=this.userProjectSelects.find((function(e){return e.id===t}));this.projectCode=e.projectCode},close:function(){this.$emit("close")},submitForm:function(t,e){var o=this;this.$refs[t].validate((function(t){if(!t)return console.log("error submit!!"),!1;o.topicProjectChange(o.topicParam.projectId);var i=o.projectCode+"_";0!==o.topicParam.topicName.indexOf(i)?o.$message({message:"Topic名称不符合规范，必须以项目名称加下划线作为前缀",type:"warning"}):(o.topicParam.topicStatus="save"===e?0:1,o.title&&(o.topicParam.id="新建Topic"===o.title?null:o.topicParam.id),"submit"===e?o.$confirm("Topic创建后需经过管理员审批通过方可使用，确定提交审批？","",{confirmButtonText:"确定",cancelButtonText:"取消",center:!0}).then((function(){o.saveOrUpdate(o.topicParam)})).catch((function(){o.$message({showClose:!0,type:"info",message:"已取消操作"})})):o.saveOrUpdate(o.topicParam))}))},saveOrUpdate:function(t){var e=this;Object(r["m"])(t).then((function(t){if(0===t.code){var o={isSubmit:!0};e.$emit("close",o),e.$notify({title:"Success",message:"新建Topic"===e.title?"Topic新建成功":"Topic修改成功",type:"success",duration:2e3})}else e.$message({showClose:!0,message:t.msg,type:"error"})}))}}},c=n,s=(o("27cb"),o("2877")),l=Object(s["a"])(c,i,a,!1,null,null,null);e["default"]=l.exports},9114:function(t,e,o){"use strict";o.r(e);var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"app-container"},[t._m(0),t._v(" "),o("Hr"),t._v(" "),o("div",{staticClass:"topic-condition"},[o("el-form",{ref:"topicForm",staticClass:"demo-form-inline",attrs:{inline:!0,"label-width":"100px","label-position":"right",model:t.topicInfo}},[o("el-row",[o("el-col",{attrs:{span:8}},[o("el-form-item",{attrs:{label:"Topic名称：",prop:"topicName"}},[o("el-input",{attrs:{placeholder:"请输入Topic名称"},model:{value:t.topicInfo.topicName,callback:function(e){t.$set(t.topicInfo,"topicName",e)},expression:"topicInfo.topicName"}})],1)],1),t._v(" "),o("el-col",{attrs:{span:8}},[o("el-form-item",{attrs:{label:"分类标签：",prop:"topicFlag"}},[o("el-input",{attrs:{placeholder:"请输入分类标签"},model:{value:t.topicInfo.topicFlag,callback:function(e){t.$set(t.topicInfo,"topicFlag",e)},expression:"topicInfo.topicFlag"}})],1)],1),t._v(" "),o("el-col",{attrs:{span:8}},[o("el-form-item",{attrs:{label:"状态：",prop:"consumerStatus"}},[o("el-select",{attrs:{placeholder:"全部"},model:{value:t.topicInfo.consumerStatus,callback:function(e){t.$set(t.topicInfo,"consumerStatus",e)},expression:"topicInfo.consumerStatus"}},t._l(t.statusOptions,(function(t,e){return o("el-option",{key:t+e,attrs:{label:t,value:e}})})),1)],1)],1)],1),t._v(" "),o("el-row",[o("el-col",{attrs:{span:8}},[o("el-form-item",{attrs:{label:"topic项目：",prop:"topicProjectId"}},[o("el-select",{attrs:{placeholder:"全部"},model:{value:t.topicInfo.topicProjectId,callback:function(e){t.$set(t.topicInfo,"topicProjectId",e)},expression:"topicInfo.topicProjectId"}},t._l(t.projectOptions,(function(t,e){return o("el-option",{key:t+e,attrs:{label:t.projectCode,value:t.id}})})),1)],1)],1),t._v(" "),o("el-col",{attrs:{span:8}},[o("el-form-item",{attrs:{label:"我的项目：",prop:"grantProjectId"}},[o("el-select",{attrs:{placeholder:"全部"},model:{value:t.topicInfo.grantProjectId,callback:function(e){t.$set(t.topicInfo,"grantProjectId",e)},expression:"topicInfo.grantProjectId"}},t._l(t.myProjectOptions,(function(t,e){return o("el-option",{key:t+e,attrs:{label:t.projectCode,value:t.id}})})),1)],1)],1),t._v(" "),o("el-form-item",{staticClass:"menu-group"},[o("el-button",{attrs:{type:"primary"},on:{click:t.handleFilter}},[t._v("搜索")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.resetForm("topicForm")}}},[t._v("重置")])],1)],1)],1)],1),t._v(" "),o("div",{staticClass:"new_topic"},[o("div",{staticClass:"topic-count"},[o("b",[t._v("订阅量：")]),o("span",[t._v("共计 "+t._s(t.total))])])]),t._v(" "),o("div",{staticClass:"topic-table"},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:t.list,border:"",fit:"","highlight-current-row":"","header-cell-style":{background:"#f7f7f7"},"row-class-name":t.tableRowClassName}},[o("el-table-column",{attrs:{prop:"topicProjectName",label:"我的项目",align:"center"}}),t._v(" "),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"topicName",label:"Topic名称",align:"left",sortable:""}}),t._v(" "),o("el-table-column",{attrs:{prop:"grantProjectName",label:"topic项目",align:"center"}}),t._v(" "),o("el-table-column",{attrs:{prop:"topicFlag",label:"分类标签",align:"center"}}),t._v(" "),o("el-table-column",{attrs:{prop:"createUser",label:"创建者",align:"center"}}),t._v(" "),o("el-table-column",{attrs:{label:"状态",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[o("span",{style:"color:"+t.statusStyle[i.isDel]+";font-size: 12px;"},[t._v("● "+t._s(t.statusOptions[i.isDel]))])]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"权限",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[o("span",[t._v(" "+t._s(t.authOptions[i.topicAuth-1]))])]}}])}),t._v(" "),o("el-table-column",{attrs:{prop:"updateTime",label:"最近更新",width:"160",align:"center",sortable:""}}),t._v(" "),o("el-table-column",{attrs:{label:"操作",align:"center",width:"150","class-name":"operation"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[1===i.isDel?o("div",{staticClass:"option-type"},[o("span",{staticClass:"view",on:{click:function(e){return t.handleRecover(i)}}},[t._v("恢复订阅")])]):o("div",[o("span",{staticClass:"view",on:{click:function(e){return t.handleView(i)}}},[t._v("查看")]),t._v(" "),o("span",{on:{click:function(e){return t.handlecancelSubscriber(i)}}},[t._v("取消订阅")])])]}}])})],1)],1),t._v(" "),o("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{total:t.total,page:t.topicInfo.page,limit:t.topicInfo.limit},on:{"update:page":function(e){return t.$set(t.topicInfo,"page",e)},"update:limit":function(e){return t.$set(t.topicInfo,"limit",e)},pagination:t.getConsumerTopicList}}),t._v(" "),o("topic-detail",{ref:"newForm",attrs:{"new-page-visible":t.newPageVisible,title:t.title,"current-row":t.currentRow},on:{close:t.handleClose}}),t._v(" "),o("view-topic",{ref:"viewForm",attrs:{"view-page-visible":t.viewPageVisible,"current-row":t.currentRow},on:{close:t.handleClose}})],1)},a=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"page-title"},[o("span",[t._v("我的订阅")])])}],r=o("b775");function n(t){return Object(r["a"])({url:"/topicAcl/consumerList",method:"post",data:t})}function c(){return Object(r["a"])({url:"/project/allProject",method:"get"})}function s(){return Object(r["a"])({url:"/project/findProjectByLoginUser",method:"get"})}function l(t){return Object(r["a"])({url:"/user/checkPasswd",method:"put",params:t})}function p(t){return Object(r["a"])({url:"/topic/reciveSubscriber",method:"post",params:t})}function u(t){return Object(r["a"])({url:"/topic/cancelSubscriber",method:"post",params:t})}var m=o("333d"),d=o("77d2"),f=o("378e"),v={name:"ConsumerManager",components:{Pagination:m["a"],TopicDetail:d["default"],ViewTopic:f["default"]},data:function(){return{total:0,list:null,topicInfo:{page:1,limit:5,topicFlag:"",topicName:"",topicProjectId:null,grantProjectId:null,consumerStatus:null},authOptions:["读","读写","读,写,删除"],statusOptions:["已订阅","已取消订阅"],statusStyle:["#67c23a","#DCDCDC"],projectOptions:[],myProjectOptions:[],title:"",currentRow:null,listLoading:!1,newPageVisible:!1,viewPageVisible:!1}},created:function(){this.getConsumerTopicList(),this.getProjectList()},methods:{tableRowClassName:function(t){var e=t.row;return 1===e.isDel?"delete-row":""},getConsumerTopicList:function(){var t=this;this.listLoading=!0,n(this.topicInfo).then((function(e){t.list=e.datas.pageData,t.total=e.datas.count,t.listLoading=!1}))},getProjectList:function(){var t=this;c().then((function(e){t.projectOptions=e.datas})),s().then((function(e){t.myProjectOptions=e.datas}))},handleFilter:function(){this.topicInfo.page=1,this.getConsumerTopicList()},handleView:function(t){var e=this;this.viewPageVisible=!0,this.$nextTick((function(){e.$refs.viewForm.$refs["samplingForm"].resetFields(),e.currentRow=t,e.$refs.viewForm.getRowData(t)}))},handleClose:function(t){this.newPageVisible=!1,this.viewPageVisible=!1,t&&t.isSubmit&&this.getConsumerTopicList()},handlecancelSubscriber:function(t){var e=this,o=t.projectId,i=t.topicName;this.$prompt("取消订阅后，应用将无法继续消费数据，是否仍然确认取消订阅？","请输入密码",{confirmButtonText:"确定",cancelButtonText:"取消",inputPlaceholder:"请输入密码",inputType:"password"}).then((function(t){var a=t.value,r={userPassword:a};l(r).then((function(t){if(0===t.code){var a={projectId:o,topicName:i};u(a).then((function(t){0===t.code?(e.$message({showClose:!0,type:"success",message:t.msg}),e.getConsumerTopicList()):e.$message({showClose:!0,type:"error",message:t.msg})}))}else e.$message({showClose:!0,message:t.msg,type:"error"})}))})).catch((function(){e.$message({showClose:!0,type:"info",message:"取消输入"})}))},handleRecover:function(t){var e=this,o=t.projectId,i=t.topicName;this.$confirm("确定要恢复该topic吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}).then((function(){var t={projectId:o,topicName:i};p(t).then((function(t){0===t.code?(e.$message({showClose:!0,type:"success",message:t.msg}),e.getConsumerTopicList()):e.$message({showClose:!0,type:"error",message:t.msg})}))})).catch((function(){e.$message({showClose:!0,type:"info",message:"已取消恢复"})}))},resetForm:function(t){this.$refs[t].resetFields()}}},h=v,g=(o("e73f"),o("2877")),b=Object(g["a"])(h,i,a,!1,null,null,null);e["default"]=b.exports},a711:function(t,e,o){},cd1c:function(t,e,o){var i=o("e853");t.exports=function(t,e){return new(i(t))(e)}},e73f:function(t,e,o){"use strict";var i=o("a711"),a=o.n(i);a.a},e853:function(t,e,o){var i=o("d3f4"),a=o("1169"),r=o("2b4c")("species");t.exports=function(t){var e;return a(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!a(e.prototype)||(e=void 0),i(e)&&(e=e[r],null===e&&(e=void 0))),void 0===e?Array:e}}}]);